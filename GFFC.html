<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Growth Function Fight Club</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
            min-height: 100vh;
        }
        .container {
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }
        h1 { text-align: center; margin-bottom: 10px; }
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .character {
            background: rgba(255,255,255,0.2);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        .character h2 { margin: 0 0 15px 0; color: #ffd700; }
        .stat { font-size: 20px; font-weight: bold; margin: 10px 0; }
        .health { color: #ff6b6b; }
        .attack { color: #4ecdc4; }
        input[type="number"] {
            width: 120px;
            padding: 10px;
            font-size: 18px;
            border: none;
            border-radius: 5px;
            margin: 10px;
        }
        button {
            background: #ffd700;
            color: #1e3c72;
            border: none;
            padding: 12px 24px;
            font-size: 18px;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s;
        }
        button:hover { transform: scale(1.05); box-shadow: 0 4px 15px rgba(255,215,0,0.5); }
        button:disabled { background: #666; cursor: not-allowed; transform: none; }
        .game-over, .game-won {
            text-align: center;
            font-size: 28px;
            margin: 40px 0;
        }
        .currency { font-size: 24px; font-weight: bold; color: #ffd700; margin: 20px 0; }
        .battle-result { 
            background: rgba(0,0,0,0.3); 
            padding: 20px; 
            border-radius: 10px; 
            margin: 20px 0;
            text-align: center;
            font-size: 20px;
        }
        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Growth Function Fight Club</h1>
        
        <div id="currencyDisplay" class="currency">üí∞ Currency: <span id="currency">500</span></div>
        
        <div id="gameScreen">
            <div class="stats-grid">
                <div id="char1" class="character">
                    <h2>‚öîÔ∏è Warrior</h2>
                    <div class="stat health">Health growth: <span id="health1">?</span></div>
                    <div class="stat attack">Attack growth: <span id="attack1">?</span></div>
                </div>
                <div id="char2" class="character">
                    <h2>üßô Mage</h2>
                    <div class="stat health">Health growth: <span id="health2">?</span></div>
                    <div class="stat attack">Attack growth: <span id="attack2">?</span></div>
                </div>
            </div>
            
            <div style="text-align: center; margin: 30px 0;">
                <label>Bet Amount (min 100): </label>
                <input type="number" id="betAmount" min="100" max="500" value="100">
                <br>
                <button onclick="gamble('warrior')">üí∞ Bet on Warrior</button>
                <button onclick="gamble('mage')">üí∞ Bet on Mage</button>
            </div>
            
            <div id="battleHistory"></div>
        </div>
        
        <div id="gameOver" class="hidden game-over">
            <div>üíÄ GAME OVER üíÄ</div>
            <p>You went bankrupt!</p>
            <button onclick="restartGame()">üîÑ Restart Game</button>
        </div>
        
        <div id="gameWon" class="hidden game-won">
            <div>üèÜ YOU WON! üèÜ</div>
            <p>You reached 10,000 currency!</p>
            <button onclick="restartGame()">üîÑ Play Again</button>
        </div>
    </div>

    <script>
        let playerCurrency = 500;
        let battleCount = 0;

        // Large hidden n used for backend calculations
        const HIDDEN_N = 9000000;

        // A richer set of growth formulas (‚âà25)
        const growthFormulas = [
            "n",              // 1
            "2n",
            "3n",
            "n^2",            // 4
            "2n^2",
            "n^3",
            "0.5n^2",
            "sqrt(n)",
            "log(n)",
            "n log(n)",       // 10
            "1000",
            "500",
            "2000",
            "1/n",
            "1/sqrt(n)",
            "1/log(n)",
            "500 + n^2",
            "500 + n^3",
            "1000 + n",
            "1000 + 2n",      // 20
            "0.1n^3",
            "0.01n^3",
            "2^((log2 n))",   // effectively n, but looks fancy
            "2^(log2 n * 1.2)",
            "n^2.5"
        ];

        // Utility: base-2 log
        function log2(x) {
            return Math.log(x) / Math.log(2);
        }

        function getStatValue(formula, n) {
            // Safe guards for log-ish formulas
            const safeN = n <= 1 ? 2 : n;
            switch (formula) {
                case "n": return n;
                case "2n": return 2 * n;
                case "3n": return 3 * n;
                case "n^2": return n * n;
                case "2n^2": return 2 * n * n;
                case "n^3": return n * n * n;
                case "0.5n^2": return 0.5 * n * n;
                case "sqrt(n)": return Math.sqrt(n);
                case "log(n)": return Math.log(safeN);
                case "n log(n)": return n * Math.log(safeN);
                case "1000": return 1000;
                case "500": return 500;
                case "2000": return 2000;
                case "1/n": return 1 / safeN;
                case "1/sqrt(n)": return 1 / Math.sqrt(safeN);
                case "1/log(n)": return 1 / Math.log(safeN);
                case "500 + n^2": return 500 + n * n;
                case "500 + n^3": return 500 + n * n * n;
                case "1000 + n": return 1000 + n;
                case "1000 + 2n": return 1000 + 2 * n;
                case "0.1n^3": return 0.1 * n * n * n;
                case "0.01n^3": return 0.01 * n * n * n;
                case "2^((log2 n))": return Math.pow(2, log2(safeN)); // == n
                case "2^(log2 n * 1.2)": return Math.pow(2, log2(safeN) * 1.2);
                case "n^2.5": return Math.pow(n, 2.5);
                default: return 500;
            }
        }

        function randomFormula() {
            const idx = Math.floor(Math.random() * growthFormulas.length);
            return growthFormulas[idx];
        }

        function generateBattle() {
            battleCount++;

            const char1Rates = {
                healthFormula: randomFormula(),
                attackFormula: randomFormula()
            };

            const char2Rates = {
                healthFormula: randomFormula(),
                attackFormula: randomFormula()
            };

            // Calculate hidden stat values with very large n
            const n = HIDDEN_N;

            const warrior = {
                health: getStatValue(char1Rates.healthFormula, n),
                attack: getStatValue(char1Rates.attackFormula, n),
                healthFormula: char1Rates.healthFormula,
                attackFormula: char1Rates.attackFormula
            };

            const mage = {
                health: getStatValue(char2Rates.healthFormula, n),
                attack: getStatValue(char2Rates.attackFormula, n),
                healthFormula: char2Rates.healthFormula,
                attackFormula: char2Rates.attackFormula
            };

            return { warrior, mage, battleNumber: battleCount };
        }

        // Winner is based on number of attacks to slay, tie-breaker is more negative HP on the victim
        function simulateBattle(warrior, mage) {
            const wHP = warrior.health;
            const wATK = warrior.attack;
            const mHP = mage.health;
            const mATK = mage.attack;

            // Avoid division by zero / degenerate cases
            const wAtkEff = wATK <= 0 ? 0.000001 : wATK;
            const mAtkEff = mATK <= 0 ? 0.000001 : mATK;

            const warriorAttacksToSlayMage = Math.ceil(mHP / wAtkEff);
            const mageAttacksToSlayWarrior = Math.ceil(wHP / mAtkEff);

            const finalMageHP = mHP - warriorAttacksToSlayMage * wAtkEff;
            const finalWarriorHP = wHP - mageAttacksToSlayWarrior * mAtkEff;

            let winner;
            if (warriorAttacksToSlayMage < mageAttacksToSlayWarrior) {
                winner = "warrior";
            } else if (mageAttacksToSlayWarrior < warriorAttacksToSlayMage) {
                winner = "mage";
            } else {
                // Same number of attacks, tiebreaker: who leaves opponent more negative
                const mageOverslay = -finalMageHP;      // how far below 0
                const warriorOverslay = -finalWarriorHP;
                if (mageOverslay > warriorOverslay) {
                    winner = "warrior";
                } else if (warriorOverslay > mageOverslay) {
                    winner = "mage";
                } else {
                    // Perfect tie ‚Äì arbitrarily pick one to avoid stalemate
                    winner = Math.random() < 0.5 ? "warrior" : "mage";
                }
            }

            return {
                winner,
                warriorAttacksToSlayMage,
                mageAttacksToSlayWarrior,
                finalWarriorHP,
                finalMageHP
            };
        }

        function updateDisplay(battle) {
            // Show ONLY formulas, hide actual values
            document.getElementById('health1').textContent = battle.warrior.healthFormula;
            document.getElementById('attack1').textContent = battle.warrior.attackFormula;
            document.getElementById('health2').textContent = battle.mage.healthFormula;
            document.getElementById('attack2').textContent = battle.mage.attackFormula;

            document.getElementById('currency').textContent = playerCurrency;
            document.getElementById('betAmount').max = playerCurrency;
        }

        function addBattleResult(result, battleNum) {
            const history = document.getElementById('battleHistory');
            const winnerText = result.winner === 'warrior' ? 'üèÜ WARRIOR WINS!' : 'üèÜ MAGE WINS!';
            const resultDiv = document.createElement('div');
            resultDiv.className = 'battle-result';
            resultDiv.innerHTML = `
                <strong>Battle #${battleNum}</strong><br>
                ${winnerText}<br>
                Warrior attacks to slay Mage: ${result.warriorAttacksToSlayMage}<br>
                Mage attacks to slay Warrior: ${result.mageAttacksToSlayWarrior}<br>
                (Extra damage used for tie-breaks)
            `;
            history.insertBefore(resultDiv, history.firstChild);
        }

        function gamble(character) {
            const bet = parseInt(document.getElementById('betAmount').value);

            if (bet < 100 || bet > playerCurrency) {
                alert('Bet must be between 100 and your current currency!');
                return;
            }

            const battle = generateBattle();
            const result = simulateBattle(battle.warrior, battle.mage);

            // Update formulas on screen
            updateDisplay(battle);

            // Log battle result
            addBattleResult(result, battle.battleNumber);

            // Payout
            const multiplier = 1;
            if (result.winner === character) {
                playerCurrency += Math.floor(bet * multiplier);
            } else {
                playerCurrency -= bet;
            }

            updateDisplay(battle);

            if (playerCurrency >= 10000) {
                document.getElementById('gameScreen').classList.add('hidden');
                document.getElementById('gameWon').classList.remove('hidden');
            } else if (playerCurrency < 100) {
                document.getElementById('gameScreen').classList.add('hidden');
                document.getElementById('gameOver').classList.remove('hidden');
            }
        }

        function restartGame() {
            playerCurrency = 500;
            battleCount = 0;
            document.getElementById('battleHistory').innerHTML = '';
            document.getElementById('gameScreen').classList.remove('hidden');
            document.getElementById('gameOver').classList.add('hidden');
            document.getElementById('gameWon').classList.add('hidden');

            const initialBattle = generateBattle();
            updateDisplay(initialBattle);
        }

        window.onload = function() {
            restartGame();
        };
    </script>
</body>
</html>
